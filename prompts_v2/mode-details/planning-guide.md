# Planning Mode - Smart Hierarchical Brainstorming

## Purpose
Smart brainstorming: unlimited levels, user-controlled depth, individual item focus with **trade-off discussions** and **LLM recommendations** for multiple valid approaches.

## Mode Detection
- `"planning"` ‚Üí standalone | `"planning tasks"` ‚Üí +tasks | `"planning skeleton"` ‚Üí +tasks+skeleton

## Process
1. **Ask task description** ‚Üí STOP for user response
2. **Auto suggest filename** ‚Üí ask user confirm suggested name
3. **Auto detect existing file** ‚Üí ask continue + detect current level if found
4. **Ask brainstorming needed** ‚Üí STOP for user response
5. **Execute smart brainstorming workflow** (resume from detected level if continuing)

## Smart Brainstorming Workflow

### Core Process (Unlimited Levels)
1. **List items** at current level
2. **Wait user confirm** before proceeding
3. **Individual brainstorming** - one item at a time
4. **Ask satisfaction** - wait OK before next item
5. **Ask go deeper** - which item to break down
6. **Repeat recursively** - unlimited levels

### Step-by-Step Execution

**Step 1: Present List**
```
Level: [Name]
Items: 1.[Item] 2.[Item] 3.[Item]
Ready to brainstorm each? (Y/n)
```

**Step 2: Individual Focus with Discussion**
- Focus ONE item: "Brainstorming [Item]..."
- **Discussion Mode**: When multiple approaches exist, present options with trade-offs + **LLM recommendation**
- **Suggestion Mode**: When clear best practice exists, provide direct guidance
- Ask: "Satisfied with [Item]? Next item? (Y/n)"
- Update files after user OK

**Step 3: Depth Decision** 
```
Level complete. Items with sub-levels:
- [Item A] ‚Üí [sub-components]
- [Item B] ‚Üí [sub-components] 
Go deeper? Which item? ('done' to finish)
```

**Step 4: Recursive Depth**
- Analyze chosen item ‚Üí create sub-level
- Repeat full process with sub-items
- Continue until user says "done"
- Support: Level 1‚Üí2‚Üí3‚ÜíN (unlimited)

### Example Flow

**Level 1**: `1.UserAuth 2.Products 3.Cart 4.Payment` ‚Üí User picks "UserAuth"
**Level 2**: `1.Login 2.Profiles 3.Permissions` ‚Üí User picks "Login"  
**Level 3**: `1.Validation 2.Sessions 3.MFA` ‚Üí Brainstorm each

**Individual Brainstorming with Discussion**:
```
Brainstorming: Login Service
Requirements: Email validation, token generation, security

Discussion: Authentication Strategy
Option 1: JWT Tokens
‚úÖ Pros: Stateless, scalable, microservices-friendly
‚ùå Cons: Token revocation complex, larger payload

Option 2: Session-based  
‚úÖ Pros: Easy revocation, smaller requests, server control
‚ùå Cons: Stateful, scaling challenges, sticky sessions

üí° My Recommendation: JWT for this case
Reasoning: Based on requirements mentioning "scalability" and modern architecture trends, JWT provides better long-term flexibility despite revocation complexity.

Which approach do you prefer? Or shall we go with my recommendation?
Satisfied with this analysis? Next item? (Y/n)
```

## Mode Behaviors

**Standalone**: Planning doc only, real-time updates
**Dual (+Tasks)**: Each item ‚Üí method listing, mirror hierarchy levels
**Triple (+Skeleton)**: Add code structure at any level, sync all files

## File Management

### Auto Filename Suggestion (GitHub Convention)
**Pattern**: `[type]-[kebab-case-name].md`
**Types**: `feat`, `fix`, `refactor`, `chore`, `docs`, `style`, `test`
**Examples**: 
- "Add user authentication" ‚Üí suggest `feat-user-authentication.md`
- "Fix login validation bug" ‚Üí suggest `fix-login-validation.md`  
- "Refactor payment service" ‚Üí suggest `refactor-payment-service.md`
- "Update API documentation" ‚Üí suggest `docs-api-update.md`
**Process**: Auto suggest ‚Üí ask user confirm ‚Üí proceed

### Existing File Detection  
**Check**: `.claude/custom/planning/[suggested-name].md` exists?
**If found**:
```
Found: feat-user-authentication.md
Content shows: Level 2 - UserAuth Sub-Components  
Continue from Level 2? Or restart? (continue/restart)
```
**Auto detect**: Parse content ‚Üí find deepest level ‚Üí resume from next

### File Template
**Location**: `.claude/custom/planning/[type]-[kebab-case].md`
**Combined**: Planning + Tasks in same file
```markdown
# User Authentication - Planning

## Level 1 - Components  
1. UserAuth ‚Üí authentication/sessions
2. TokenManager ‚Üí session handling

## Level 2 - UserAuth Sub-Components
1. LoginService ‚Üí credential validation  
2. SessionManager ‚Üí token lifecycle

### LoginService (Level 2 Item)
**Problem**: Secure user authentication
**Requirements**: Email validation, token generation
**Design**: JWT vs sessions, expiry policies

---
# Tasks Section

## Level 1 - Components
- [ ] UserAuth ‚Üí src/auth/AuthService.ts
- [ ] TokenManager ‚Üí src/auth/SessionManager.ts

## Level 2 - UserAuth Methods  
**Target**: `src/auth/AuthService.ts`
- [ ] login(credentials) ‚Üí validate and create session
- [ ] validateSession(token) ‚Üí check validity
```

## Discussion Patterns

### When to Use Discussion Mode
- **Multiple valid approaches** exist without clear best practice
- **Architecture decisions** with significant trade-offs
- **Technology choices** depending on context
- **Design patterns** with different benefits

### Discussion Template with LLM Recommendation
```
Component: [Item Name]
Requirements: [What needs to be solved]

Discussion: [Multiple Approaches Available]
Option 1: [Approach A]
‚úÖ Pros: [Benefits]
‚ùå Cons: [Drawbacks]

Option 2: [Approach B]  
‚úÖ Pros: [Benefits]
‚ùå Cons: [Drawbacks]

üí° My Recommendation: [Preferred Option]
Reasoning: [Why this fits better - context, requirements, best practices]

Which approach do you prefer? Or shall we go with my recommendation?
Satisfied with this analysis? Next item? (Y/n)
```

## Integration
- **Context**: BUSINESS-CONTEXT.md, ARCHITECTURE.md, CODEBASE-MAP.md
- **Mode switching**: Activate tasks/skeleton mid-conversation  
- **Updates**: Files update after each item satisfaction with chosen approach
- **Error handling**: Follow shared-patterns.md